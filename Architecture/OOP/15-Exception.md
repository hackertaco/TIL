## try/catch/finally
예외는 개체지향은 아니다. 
- try: 시도할 코드들
- catch: 예외가 발생할 경우 해당 예외를 처리할 코드
  - 하나 이상 가능
  - 예외 클래스를 둘 수 있다. IOException, ArithmeticException, IndexOutOfBoundsException...
  - 특정 어렵거나 모든 예외를 잡고 싶으면 Exception class
  - 다중 catch 블록 작성시 주의할 것은 부모 예외 클래스가 자식보다 먼저 나오면 안된다. 
- finally: 예외 발생 여부와 상관없이 항상 실행되는 코드
  - 이건 없어도 된다.

### 사용예
1. try-catch
   - 
2. finally
   - try, catch 모두에 적을 코드가 있다면, finally
   - 정리하거나 해제해야할 코드가 있으면 써야한다.
   - > if(out != null){try{out.close();}catch(){}}

### rethrow
어떤 예외를 잡았지만 다시 호출자에게 던져야할 - 호출 스택을 유지하면서 던져야한다. 
- 위로 던지는 거라서 좋은 습관은 아니다.

### 나만의 예외를 만들 때, 
RuntimeException을 상속 받게 된다. 

예외를 처리하면 JVM에서 프로그램을 종료시켜준다.
근데 예외가 없는 C같은 언어는 OS/기계를 어떤 걸 쓰는지에 따라 다르다. 옛날에는 하드웨어가 멈추기도 했다.

근데 사람의 지속적인 조작없이 알아서 실행돼야하는 프로그램이라면? 웹서버처럼? 크래시가 나면 기계를 재부팅을 할 수 없는 사람들..

요즘은 가상 메모리들이 있어서, cpu에서 인터럽트나 시그널을 보냈을 때 OS가 캐치 후 프로그램 종료, 가상 메모리 해제함

## 예외처리를 제대로 하지 못하는 이유
어느 함수에서 어떤 예외를 던지는지 한 눈에 안 보인다. 알려면 모든 함수의 속을 다 보며 확인해야하는데 너무 함수가 많다.

그래서 모든 것에 대한 예외처리를 제대로 하지 못한다. 

## Java checked 예외
예외를 두 분류로 나누었다. 
checked, unchecked 예외

- unchecked 예외는 C# 예외와 동일하다. 
  - 어디서 어떤 예외가 나는지 한눈에 안 보인다. 
  - RuntimeException 상속
- checked 예외는 컴파일러가 예외처리를 제대로 하는지 확인해준다. 
  - try-catch, method 상속
  - public User findUser(String username) throws UserNotFoundException{}
  - throw 절 안 넣어주면 컴파일오류 뜬다. 
  - Exception 상속 
  - 예전에는 다 checked로 짜기를 바랐다. 그러나 일종의 실패! 이건 클라이언트가 반드시 처리해야할 예외라고 알려주는 용도인데, 그 처리한다는 의미가 무엇인지 분명하지 않다. 
  - 어떻게든 에러를 고쳐라는 의미! 회복하라는 뜻이다. 

## 예외로부터 안전한 프로그래밍
에러를 회복하는 게 말처럼 쉽지는 않다. 
모든 예외를 고치는 게 안전한 게 아님. 

## 그래서 예외 처리 트렌드가 unchecked
checked 예외를 unchecked 예외로 감싸서 던지자라고 한다. 
1. 그냥 unchecked 예외 사용
2. 예외로부터 안전한 최선의 방법은 재부팅. 대부분은 예외로부터 회복하지않는다. 

- 그래서 얼마나 세분화해서 처리해야하는지에 대한 의견들도 원래는 예외를 종류별로 catch했는데, 요즘은 모든 예외는 한번에 처리하자고 한다.
- 그래서 rethrow도 훨씬 적어졌다. 
- 한번에 예외를 잡자. 로깅도 하는 의미에서.

### 잘못된 예외 처리 가이드를 조심해야한다. 
아직도 모든 예외로부터 회복해야한다는 웹사이트가 많다. 
아무래도 옛날 하드웨어와 OS 문제에 대한 공포가 남아있기 때문인 것으로 추정.

상황에 맞는 예외처리 방법을 택해야한다.

### 제어흐름용으로 예외를 사용하지 말 것!! 
goto와 개념이 같다. 
다음에 실행할 코드를 결정하는 용도로 쓰면 안된다.

왜? 예외를 제어용으로 사용하기 시작하면 goto 보다 나빠진다. 

## 예외적인 상황에서만 예외를 사용해야하는 경우
할 수 있다고 다 해야하는 건 아니다. 
- 내가 모르는 문제에 봉착할 수도 있다.
![img_4.png](img_4.png)
- 1초마다 예외를 5개 던지고 처리하는 프로그램을 디버깅한다면? 
  - 뭘 조금만 건드려도 여기저기서 쾅쾅 터진다 ^^
  - 예외를 떡칠하면 터지기는 너무 쉽당. 
  - 문제가 생길 때만 중단점으로 볼 수 있는데, 그럼 예외 발생지점을 쉽게 찾을 수 있다. 
  - 근데 프로그램 처음 시작할 때 이미 예외가 200개가 나오는데 어떻게 하나씩 continue 버튼을 누르며 디버깅을 할까? 
  - 즉 실무에서는 말이 안된다. 
  - 혼자 이상하게 사용하면 툴의 혜택을 못 받는 것. 예외는 예외 상황에서만 사용할 것.

## 오류 상황, 예외 상황
프로그램은 기본적으로 아무 오류 없을 거라 가정하고 진행된다. 
그런 경우가 아닐 경우, 
오류 혹은 예외 상황이라한다.

- 오류 상황은 예측 가능한 상황
  - 프로그램 실행 중에 기본적으로 일어나지 않는 일이지만 일어날 수 있는 일
  - 프로그래머가 이를 예측지 못하면, 버그

### 4가지 오류 상황 처리법
1. 무시하고 넘어간다.
2. 문제를 일으킬 수 있는 상황이 있는지 검사하고, 그렇다면 프로그램을 종료한다. (종료)
3. 문제를 일으킬 수 있는 상황이 있는지 검사하고, 그렇다면 실수를 고친 뒤 계속 프로그램을 실행되게 한다. (수정)
4. 문제가 발생하면 예외를 던진다. (예외)

한동안 4만 하면 프로그램 품질이 높아진다고 하던 사람들이 있었다. 개체지향의 본질이라고 말하는 것이다. 
