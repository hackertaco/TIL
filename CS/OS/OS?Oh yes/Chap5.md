병행: 같이 존재한다. = 메모리에 다수의 프로세스가 같이 존재한다.

단일처리 시스템 -> 병행 프로세스 중 한개만 실제로 실행. 하지만 겉으로 보았을 때는 동시에 처리되는 것처럼 보인다. 논리적 병행성
다중처리 시스템 -> 여러 개의 프로세스가 동시에 병렬로 실행될 수 있다. 물리적 병행성

병행 프로세스는 비동기적 -> 서로의 메모리 상태나 데이터를 잘 모르기에, 관리하지 못한 채 방치할 경우 문제가 생길 수 있음.

## 병행 프로세스
병행 프로세스는 메모리를 공유한다. 
자원의 접근에 대하여는 일정한 룰을 따라야한다. 한번에 한 프로세스만이 접근하도록 하고, 해당 자원에 대해 의도한 실행을 완료하도록 보장한다.
이 접근이 제대로 처리되지않으면, 정확한 값을 가질 수 없게 될 수 있다.

## 상호 배제
공유 데이터에 여러 프로세스들이 접근을 시도하는 상황을 경쟁 상태라고 하며, 이를 잘 해결하기위해 프로세스들끼리 상호배제를 해야한다.
동시에 사용할 수 없는 자원을 임계자원이라 부르고, 그 코드 영역을 임계 영역이라 부른다. 
임계영역의 실행을 위해서는 상호배제가 지켜져야한다.
임계영역에 없는 프로세스가 다른 영역의 임계영역 프로세스 접근하는 것을 막는 것은 안되고, 
빈 임계영역 진입은 바로 허용하되, 시도가 무산되어 기아를 겪지 않도록 한다.
이미 들어가있다면 기다리고, 없다면 들어가면서 다른 프로세스가 들어오지 않도록 해야한다.

 ### 상호배제 잘못된 시도들
1. turn 값을 프로세스별로 다른 상황일 때 임계영역에 들어갈 수 있을 때
   이 경우 턴 값이 0일 때는 항상 일정한 프로세스만이 먼저 시작 가능.
   번갈아 한번씩만 실행될 수 있음.
   
2. flag를 두어서 true/false로 구분하는 방식은 1의 문제를 해결할 수는 있지만, 둘 다 동시에 임계영역에 들어갈 수 있게 된다.
3. flag 위치를 변경하게되어도, 둘 다 임계 영역에 진입하지 못하게되는 문제가 있다. 
4. 라이브락: 시점에 조금 잘못이 생기면 임계 영역에 진입이 불가하다.

### 상호배제 성공적인 기법
turn과 flag 모두를 사용한 기법. 데커가 너무 어렵게 만들어놓은 것을 피터슨이 쉽게 바꾸었다.

### n 프로세스 간의 상호배제를 위한 소프트웨어 기법
여러개의 프로세스끼리의 상호배제를 위한 기법 중, 베이커리 알고리즘은 분산시스템용으로도 소개되었으나 n개의 프로세스들을 대상으로 하는 상호배제 기법으로도 유용하다.


이러한 기법들은 운영체제의 지원이 아니라, 프로세스 간 협력을 통해 상호배제를 실현하는 것이라 실행 시 부하가 크고, 실수로 인한 오류의 가능성도 높다.

## 상호 배제를 위한 하드웨어 기법들
### 인터럽트 금지를 사용한 기법
단일처리 시스템의 경우 CPU를 번갈아 사용하는 것이라, 한 프로세스가 임계영역에서 실행 중일 때, 인터럽트를 넣어줘서 상호배제를 지켜줄 수 있다. 
근데 이 경우 모든 종류의 인터럽트를 금지하게 되어 효율적이지 않을 수 있다.
다중처리 시스템에서는 다른 처리기에서 실행되는 프로세스로부터의 접근 가능성이 있어서, 사용하기 힘들다. 

그래서, 하드웨어의 명령어로 이를 해결해보고자한다. 
### 하드웨어 명령어를 사용한 기법 
- testandset
- exchange
이용해서, 전역 변수를 활용한 상호배제 알고리즘을 만든다. 
- 기계 명령어를 이용하면 간단하고, 다중처리 시스템에서도 쉽게 쓸 수 있다. 여러개의 임계영역도 지원 가능하다. 
- 그러나, 여전히 바쁜 대기를 하고, 차례가 정해지지않아 어떤 프로세스는 기아를 겪고, 높은 우선순위 프로세스에 CPU를 뺏기면 교착 상태에 빠질수도있다.